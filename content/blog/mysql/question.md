---
title: "常见问题"
date: 2021-10-31T10:08:33+08:00
weight: 2
---

+ 能说下myisam 和 innodb的区别吗  
myisam引擎是5.1版本之前的默认引擎，支持全文检索、压缩、空间函数等，但是不支持事务和行级锁，所以一般用于有大量查询少量插入的场景来使用，而且myisam不支持外键，并且索引和数据是分开存储的。  
innodb是基于聚簇索引建立的，和myisam相反它支持事务、外键，并且通过MVCC来支持高并发，索引和数据存储在一起。

+  说下mysql的索引有哪些吧，聚簇和非聚簇索引又是什么？  
```
create table user(
 id int(11) not null,
  age int(11) not null,
  primary key(id),
  key(age)
);
```
B+树是左小右大的顺序存储结构，节点只包含id索引列，而叶子节点包含索引列和数据，这种数据和索引在一起存储的索引方式叫做聚簇索引，一张表只能有一个聚簇索引。假设没有定义主键，InnoDB会选择一个唯一的非空索引代替，如果没有的话则会隐式定义一个主键作为聚簇索引。


+ 事务的基本特性  
原子性指的是一个事务中的操作要么全部成功，要么全部失败。  
一致性指的是数据库总是从一个一致性的状态转换到另外一个一致性的状态。比如A转账给B100块钱，假设中间sql执行过程中系统崩溃A也不会损失100块，因为事务没有提交，修改也就不会保存到数据库。  
隔离性指的是一个事务的修改在最终提交前，对其他事务是不可见的。  
持久性指的是一旦事务提交，所做的修改就会永久保存到数据库中。

+ 主从同步  
首先先了解mysql主从同步的原理
master提交完事务后，写入binlog  
slave连接到master，获取binlog  
master创建dump线程，推送binglog到slave  
slave启动一个IO线程读取同步过来的master的binlog，记录到relay log中继日志中  
slave再开启一个sql线程读取relay log事件并在slave执行，完成同步  
slave记录自己的binglog  